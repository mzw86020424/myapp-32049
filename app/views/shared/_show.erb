<style>

  .col-md-6 {
    margin:5px 0 
    position: relative;
  }
  svg {
    position: absolute;
    right: 3px;
    height: 10%;
    width: 10%;
  }

  .col-md-6 img {
    /* width:100%; */
    max-width: 100%;
    height: auto;
  }

  .sortable-chosen {
    opacity: .6;
}
</style>

<body class="container-fluid">

<% if current_user == @zine.user %>
<p>
  <strong>PRIVATE</strong>
    <%= check_box_tag 'zine[private]', true, @zine[:private], {
      onchange: '$(this).data("params", "zine[private]=" + this.checked)',
        data: {
          url: zine_url + '/user_private/',
            method: :post,
            remote: true
        }
    } %>
</p>
<% end %>

  <div>
    <div class="sortable row">
    <% @posts.each_with_index do |post,i| %>
      <div class="col-md-6 content-post rounded shadow text-danger" id="<%=i%>">
      <% if current_user == @zine.user %>
        <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-bookmark-fill" viewBox="0 0 16 16">
          <path fill-rule="evenodd" d="M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v13.5a.5.5 0 0 1-.74.439L8 13.069l-5.26 2.87A.5.5 0 0 1 2 15.5V2z"/>
        </svg> 
      <% end %>
        <%= link_to image_tag(thumbalizr_url(post.url, {:country => 'ja', :width =>  960})), post.url, :target => "_blank", class: 'link' %>
      </div>
    <% end %> 
    </div>
  </div>

<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.5.1.js" integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc=" crossorigin="anonymous"></script>


<!-- jQuery UI -->
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js" integrity="sha256-T0Vest3yCU7pafRw9r+settMBX6JkKN06dqBnpQ8d30=" crossorigin="anonymous"></script>


<%# Sortable %>
<script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>

<%# jQuery UI Touch Punch %>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui-touch-punch/0.2.3/jquery.ui.touch-punch.min.js"></script>
<!-- jQuery cookie -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>


<%# sortable %>
<script type="text/javascript">
$(function() {
    $(".sortable").sortable({
          scroll: true,
          cursor: "move",
          handle: 'svg',
          tolerance: "pointer"
        });
    $(".sortable").disableSelection();
    $(".sortable").sortable({
        update: function(ev, ui) {
            var updateArray =  $(".sortable").sortable("toArray").join(",");
            $.cookie("sortable", updateArray, {expires: 30});
        }       
    });
    if($.cookie("sortable")) {
        var cookieValue = $.cookie("sortable").split(",").reverse();
        $.each(
            cookieValue,
            function(index, value) {$('#'+value).prependTo(".sortable");}
        );
    }
});
</script>

</body>